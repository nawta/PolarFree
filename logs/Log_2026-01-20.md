# 開発ログ 2026-01-20

## PSD Dataset を使用した学習

### 実施内容

1. **PSDデータセット適応の完了**
   - `psd_dataset.py`: PSDの12角度から4角度への変換を行うデータセットローダー
   - `psd_stage1.yml`: Stage 1学習設定
   - `psd_stage2.yml`: Stage 2学習設定
   - `docs/specular_removal_design.md`: 設計ドキュメント

2. **データセット量の比較**
   | Dataset | Train | Val/Test | Total |
   |---------|-------|----------|-------|
   | PolaRGB | 6,312枚 | 188枚 | ~6,500枚 |
   | PSD | 642グループ | 246グループ | ~888グループ |

3. **Stage 1 学習開始**
   - 設定ファイル: `options/train/psd_stage1.yml`
   - イテレーション: 100,000
   - バッチサイズ: 2
   - 学習率: 1e-4 (cosine annealing)

### 学習ログ

```
[学習開始時刻]: 2026-01-20 14:00
[再開時刻]: 2026-01-20 15:21 (iter 5000から)
[現在のイテレーション]: 7,500 / 100,000
[推定残り時間]: ~8.5時間
```

### 修正内容

1. **psd_dataset.py修正**
   - PSD val/TestのフォルダはTrain(aligned/unaligned)と異なる構造
   - Train: `PSD_Train_group/aligned/group-XXXX-idx-YY.png`
   - val: `PSD_val_group/group-XXXX-idx-YY.png` (直接配置)
   - Test: `PSD_Test_group/test-XXXX-idx-YY.png` (異なるプレフィックス)

2. **PolarFree_S1_model.py修正**
   - 空のデータローダーでバリデーション実行時のエラーを修正
   - `len(dataloader) > 0`のチェックを追加

### Stage 1 結果

```
[完了時刻]: 2026-01-20 23:54
[総イテレーション]: 100,000
[Best PSNR]: 37.27 dB @ 95,000 iter
[学習時間]: 8:33:06
```

### Stage 2 学習開始

```
[開始時刻]: 2026-01-21 01:53
[総イテレーション]: 300,000
[推定学習時間]: ~30時間
```

### 次のステップ

- Stage 2完了後、評価を行い結果を記録
- Testデータセットでの評価
